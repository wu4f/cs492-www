<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Portland State University CS 492/592: Malware Reverse
      Engineering</title>
    <!-- Bootstrap Core CSS -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="../css/onepage_notables.css" rel="stylesheet">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top"
      role="navigation">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header"> <button type="button"
            class="navbar-toggle" data-toggle="collapse"
            data-target="#bs-example-navbar-collapse-1"> <span
              class="sr-only">Toggle navigation</span> <span
              class="icon-bar"></span> <span class="icon-bar"></span> <span
              class="icon-bar"></span></button> <a class="navbar-brand"
            href="#home">CS 492/592</a></div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse"
          id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="#home" data-toggle="collapse"
                data-target=".navbar-collapse.in">Home</a> </li>
            <li><a href="#schedule" data-toggle="collapse"
                data-target=".navbar-collapse.in">Schedule</a> </li>
            <li><a href="#assignments" data-toggle="collapse"
                data-target=".navbar-collapse.in">Assignments</a> </li>
            <li><a href="#objectives" data-toggle="collapse"
                data-target=".navbar-collapse.in">Objectives</a> </li>
            <li><a href="#policies" data-toggle="collapse"
                data-target=".navbar-collapse.in">Policies</a> </li>
          </ul>
        </div>
        <!-- /.navbar-collapse --> </div>
      <!-- /.container --> </nav>
    <!-- Full Width Image Header -->
    <header class="header-image"></header>
    <!-- Page Content -->
    <div class="container">
      <!-- Begin home Featurette -->
      <div class="featurette lead" id="home">
        <div class="col-md-12">
          <h4 class="featurette-heading">Malware Reverse Engineering</h4>
        </div>
        <div class="col-md-6 col-xs-12"><span style="font-weight: bold;">Instructor:</span>
          <a href="https://thefengs.com/wuchang">Wu-chang Feng</a><br>
          <span style="font-weight: bold;">Contact and discussion: </span>
          <ul>
            <li>DM @wuchang <a href="https://pdx-cs.slack.com/">pdx-cs.slack.com</a>
            </li>
            <li>Post on channel <a
                href="https://pdx-cs.slack.com/messages/C85BX4KCG/details/">#cs492_592_malware</a>
            </li>
            <li>In-class questions/feedback anonymously <a
                href="https://sayat.me/wu4f">sayat.me</a> </li>
          </ul>
          <span style="font-weight: bold;">Office hours: </span><a
href="http://www.pdx.edu/computer-science/computer-science-academic-faculty">here</a><br>
          <span style="font-weight: bold;">TA: </span>Jeff De Lamare
          @dejef<br>
          <span style="font-weight: bold;">TA Office hours: </span>Mondays
          10:30am-12:30pm (Fishbowl)<br>
          <span style="font-weight: bold;">Required textbook</span>
          <ul>
            <li><a href="https://www.nostarch.com/malware">Practical
                Malware Analysis</a>, Sikorski and Honig, No Starch
              Press, 2013.&nbsp; ISBN-13: 978-1-59327-290-6.</li>
          </ul>
        </div>
        <div class="col-md-6 col-xs-12"> <span style="font-weight:
            bold;">Resources</span>
          <ul>
            <li>Slides and labs <a
href="https://drive.google.com/drive/folders/1KdILhorv61f_v3VvUIx5KYxcI8yJvz_3?usp=sharing">Google
                Drive</a></li>
            <!--<li>Lab <a
		    href="Slides/CS492_Labs.pptx">assignments</a></li>-->
            <li>Lecture screencasts on <a
                href="https://media.pdx.edu/channel/2019Winter_Malware/108100202">MediaSpace</a></li>
            <li>CS 201 Review <a
                href="https://media.pdx.edu/channel/CSP/62663652">screencasts</a></li>
            <li>Accounts on <a href="http://cat.pdx.edu/students.html">linuxlab</a>
              (FAB 88-09, 88-10)</li>
            <li>Lab VM at /stash/cs492/492_WinXP_x86.ova</li>
            <li>Homework <a href="https://malware.oregonctf.org/">site</a></li>
            <li>Course <a
                href="https://thefengs.com/wuchang/cv/teaching.html">reviews</a></li>
            <li>Google's <a
href="https://edu.google.com/why-google/case-studies/portland-state-cybersecurity-cloud">write-up</a></li>
          </ul>
        </div>
      </div>
      <!-- End home Featurette -->
      <!-- Begin schedule Featurette -->
      <hr class="featurette-divider">
      <div class="featurette lead" id="schedule">
        <div class="col-md-12">
          <h4 class="featurette-heading">Schedule</h4>
        </div>
        <section id="no-more-tables" style="margin-left: 20px;">
          <table class="table-bordered table-striped table-condensed cf">
            <thead class="cf"><tr>
                <th>Week</th>
                <th>Topic</th>
                <th>Slides</th>
                <th>Labs</th>
                <th>Homework</th>
              </tr>
            </thead> <tbody>
              <tr>
                <td data-title="Wk">1</td>
                <td data-title="">Introduction<br>
                  Motivation<br>
                  Basic Analysis<br>
                  <div style="margin-left: 20px;"> Chapter 1: Basic
                    Static Techniques<br>
                    Chapter 2: Malware Analysis in VMs<br>
                    Chapter 3: Basic Dynamic Analysis </div>
                </td>
                <td data-title="">00_Intro<br>
                  <a
href="https://www.usenix.org/conference/usenix-security-11/three-cyber-war-fallacies">talk</a><br>
                  <br>
                  01_BasicTechniquesTools<br>
                  <br>
                  <br>
                </td>
                <td data-title=""> <a
href="https://media.pdx.edu/media/CS+492+592+VM+installation+EB+325/0_9i70tu15/82107362">Install VM (EB 325)</a><br>
                  1-1, 1-2<br>
                  3-2, 3-4 </td>
                <td data-title=""> Ch01, Ch03<br>
                </td>
              </tr>
              <tr>
                <td data-title="Wk">2</td>
                <td data-title="">Advanced Static Analysis<br>
                  <div style="margin-left: 20px;"> Chapter 4: x86
                    Assembly<br>
                    Chapter 5: IDA Pro<br>
                    Chapter 6: C code in Assembly<br>
                  </div>
                </td>
                <td data-title=""> 02_C_x86_Windows<br>
                </td>
                <td data-title=""> 5-1<br>
                  6-1, 6-2 </td>
                <td data-title="">Ch04, Ch06</td>
              </tr>
              <tr>
                <td>3</td>
                <td>
                  <div style="margin-left: 20px;"> Chapter 7: Malicious
                    Windows Programs<br>
                    Chapter 8: Debugging<br>
                    Chapter 9: OllyDbg </div>
                </td>
                <td>03_Debugging<br>
                </td>
                <td> 7-2<br>
                  9-2<br>
                </td>
                <td>Ch08<br>
                </td>
              </tr>
              <tr>
                <td>4</td>
                <td> Advanced Dynamic Analysis<br>
                  Malware Functionality<br>
                  <div style="margin-left: 20px;"> Chapter 11: Malware
                    Behavior <br>
                    Chapter 12: Covert Launching </div>
                </td>
                <td> 04_Functionality<br>
                </td>
                <td> 11-1<br>
                  12-1, 12-3 </td>
                <td>Ch11, Ch12 </td>
              </tr>
              <tr>
                <td>5</td>
                <td>
                  <div style="margin-left: 20px;"> Chapter 13: Data
                    Encoding<br>
                    Chapter 14: Network Signatures </div>
                  Anti-Reverse-Engineering
                  <div style="margin-left: 20px;"> Chapter 15:
                    Anti-Disassembly<br>
                    &nbsp;&nbsp;Software Armoring<br>
                  </div>
                </td>
                <td><br>
                  <br>
                  05_AntiReverse<br>
                  <a href="https://www.youtube.com/watch?v=wdFLK_eX0QY">talk</a><br>
                </td>
                <td>13-1, 14-1<br>
                  15-1, 15-2 </td>
                <td>Ch13, Ch15 </td>
              </tr>
              <tr>
                <td>6</td>
                <td>
                  <div style="margin-left: 20px;"> Chapter 16:
                    Anti-Debugging<br>
                    Chapter 17: Anti-VM Techniques<br>
                    &nbsp;&nbsp;BluePill </div>
                </td>
                <td><br>
                  <br>
                  Talks <a href="https://youtu.be/T6BGsv6rmYw">#1</a>,<a
                    href="https://youtu.be/WkxzAWKog-o">#2</a> | Slides
                  <a href="files/BluePill.pdf">#1</a>,<a
                    href="files/BH2007_VirtRootkitDetection.pdf">#2</a><br>
                </td>
                <td>16-1, 17-1</td>
                <td>Ch16<br>
                </td>
              </tr>
              <tr>
                <td>7</td>
                <td>
                  <div style="margin-left: 20px;"> Chapter 18: Packers
                    and Unpacking<br>
                  </div>
                  Special Topics
                  <div style="margin-left: 20px;"> Chapter 19: Shellcode
                    Analysis<br>
                    Chapter 20: C++ Analysis<br>
                    Chapter 21: 64-bit Malware<br>
                  </div>
                  Final project: MetaCTF source walkthrough </td>
                <td><br>
                  <br>
                  06_Special<br>
                  <br>
                  <br>
                  MetaCTF level <a href="files/meta_src.zip">src</a><br>
                </td>
                <td>18-1<br>
                  <!-- 19-2, 19-3, 20-1--> </td>
                <td>Ch18, Ch 21</td>
              </tr>
              <tr>
                <td>8<br>
                </td>
                <td> &nbsp;&nbsp;&nbsp;&nbsp; Fuzzing<br>
                  &nbsp;&nbsp;&nbsp;&nbsp; Symbolic execution/analysis </td>
                <td>07_Fuzzing_SymbolicExecution<br>
                  <br>
                </td>
                <td><a href="https://codelabs.cs.pdx.edu/cs492">AFL labs</a><br>
                  <a href="https://codelabs.cs.pdx.edu/cs492">angr labs/CTF</a><br>
                  <!--<a href="./angr_install_linuxlab.txt">Linuxlab</a><br>-->
                  <!--<a href="./angr_install_docker.txt">Docker</a>-->
                </td>
                <td>00, 01, 02&nbsp;<br>
                </td>
              </tr>
              <tr>
                <td>9</td>
                <td>&nbsp;&nbsp;&nbsp;&nbsp; Symbolic execution/analysis<br>
                </td>
                <td>&nbsp; </td>
                <td>angr labs/CTF </td>
                <td>03, 05, 06<br>
                  08, 10, 11, 13 </td>
              </tr>
              <tr>
                <td>10<br>
                </td>
                <td>&nbsp;&nbsp;&nbsp;&nbsp; Symbolic execution/analysis</td>
                <td><br>
                </td>
                <td>angr labs/CTF<br>
                </td>
                <td>15, 16, 17<br>
                </td>
              </tr>
              <tr>
                <td>Sat. 3/16<br>
                  &nbsp;(11:59pm)</td>
                <td>Final project due in D2L</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
              </tr>
              <tr>
                <td>Tue. 3/19<br>
                  &nbsp;(10:15am-12:05pm)</td>
                <td>Final CTF</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td> <a href="Ch-Projects.zip">Download</a><br>
                  <a
href="https://docs.google.com/spreadsheets/d/1YBwOO7onEHXyEncrDiHy0FvpXJMtfEBf9AYIA1ZrnRM/edit?usp=sharing">Scoresheet</a>
                </td>
              </tr>
              <tr>
                <td>Sun. 3/24<br>
                  &nbsp;(11:59pm)</td>
                <td>Late homework deadline (for 80% credit)</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
              </tr>
            </tbody>
          </table>
        </section>
      </div>
      <!-- End schedule Featurette -->
      <!-- Begin assignments Featurette -->
      <hr class="featurette-divider">
      <div class="featurette lead" id="assignments">
        <div class="col-md-12">
          <h4 class="featurette-heading">Assignments</h4>
        </div>
        <div class="col-md-6 col-xs-12"> <span style="font-weight:
            bold;">Lab notebook</span><br>
          As part of the lab work, you will maintain a lab notebook (a
          single Google Doc, Microsoft Office, or LibreOffice file) that
          will contain your write-ups of each lab. The write-up should
          include answers to questions asked and screenshots of the
          completed work (via gnome-screenshot, gimp, Print Screen,
          etc.). The notebook will be graded based upon thoroughness and
          clarity of the write-ups. While you are encouraged to work
          together on labs, each student should submit an individual
          notebook each week. Notebooks must be submitted in the
          associated D2L dropbox on Monday at 11:30pm the week after
          they are assigned. For example, 1-1 and 1-2 are assigned for
          the first week of class and are due on Monday the following
          week. Ensure your notebook is properly uploaded each week. <br>
          <br>
          <br>
        </div>
        <div class="col-md-6 col-xs-12"> <span style="font-weight:
            bold;">Homework (MetaCTF)</span><br>
          For homework, we will be applying the concepts learned in the
          labs to Linux binaries. Assignments are to be done
          individually at the following site: <a
            href="https://malware.oregonctf.org">malware.oregonctf.org</a>.
          Binaries are unique to each student and no collaboration is
          allowed. The binaries implement a set of capture-the-flag
          challenges that require you to reverse engineer a set of
          binary executables. Each binary asks for a password that will
          unlock it and print "Good Job". While you will be running
          binaries on your own machine, answers to each should be
          submitted at the above site. The homework is intended to give
          you practice for the final exam CTF. To obtain full credit,
          levels associated with a particular chapter must be completed
          by Monday at 11:30pm the week after they are assigned. For
          example, Ch01 and Ch03 levels are assigned for the first week
          of class and are due on Monday the following week. Partial
          credit will be given at the end of the course for levels that
          are turned in late.<br>
          <br>
          To download binaries on a linuxlab machine, do the following:<br>
          <pre>mkdir metactf; cd metactf; virtualenv env
source env/bin/activate
pip install requests bs4
wget http://thefengs.com/wuchang/courses/cs492/meta_dl.py
python meta_dl.py malware.oregonctf.org <i>username password</i></pre>
          If you wish, instead, to run the binaries on a Ubuntu VM of
          your own, directions for doing so are <a
            href="http://thefengs.com/wuchang/courses/ubuntu_virtualbox.txt">here</a>.
          Note that you must ensure that radare2 and the 32-bit
          libraries are installed on the VM by performing
          <pre>sudo apt-get install gcc-multilib radare2</pre>
          <br>
          . </div>
        <div class="col-md-6 col-xs-12"> <span style="font-weight:
            bold;">Final project (Option #1: MetaCTF level)</span><br>
          (Undergraduates only, Individual projects) "See one, Do one,
          Teach one". The goal of this project will be to develop your
          own metamorphic challenge that can be used to help someone
          learn a topic covered in this course that is not currently
          addressed in your homework assignment. Source code for several
          of the early MetaCTF challenges will be given as a template.
          After doing so, you will create a narrated screencast that
          walks-through the source code of your level and a demo of how
          you would go about solving the level using an actual binary.
          Screencast software and submission are to be done via PSU's
          MediaSpace on the course's channel. After uploading your
          screencast to MediaSpace, ensure that the screencast is
          published onto the course channel. We will solve each others'
          projects after the final exam. At a minimum, levels should:
          <ul>
            <li>Be tied to a single topic or technique. Levels that span
              multiple techniques are not recommended. </li>
            <li>Be generated metamorphically using methods equivalent to
              the current MetaCTF challenges. </li>
            <li>Have the same format as the current MetaCTF challenges
              as described in the following <a
                href="./ctf_submission.html">instructions</a>. </li>
          </ul>
          The rubric can be found <a href="./rubric_ctf.txt">here</a>.<br>
          <br>
        </div>
        <div class="col-md-6 col-xs-12"> <span style="font-weight:
            bold;">Final project (Option #2: Malware RCE)</span><br>
          (Individual or Group projects) The goal of this final project
          is to reverse-engineer a piece of malware of your choice using
          everything you have learned in this course. After doing so,
          you will create a narrated screencast that walks-through your
          process of obtaining the malware, running the analysis on it,
          and analyzing its behavior. Properly edit the screencast so
          that your analysis is under 20 minutes long per person.
          Screencast software and submission are to be done via PSU's
          MediaSpace on the course's channel. Resources for malware:
          <ul>
            <li><a href="https://virustotal.com/">VirusTotal</a><br>
            </li>
            <li>Daily Dose of Malware <a
                href="https://github.com/woj-ciech/Daily-dose-of-malware">script</a><br>
              <ul>
                <li><a href="https://malshare.com/">MalShare</a><br>
                </li>
                <li><a href="https://malc0de.com/">Malc0de</a><br>
                </li>
                <li><a href="https://cymon.io">Cymon</a><br>
                </li>
              </ul>
            </li>
            <li><a
                href="https://github.com/rshipp/awesome-malware-analysis">awesome
                malware analysis</a></li>
            <li><a href="https://github.com/ytisf/theZoo">theZoo</a></li>
          </ul>
          If done as a group, each student will narrate the part of the
          malware he/she has reverse-engineered. The rubric can be found
          <a href="./rubric_rce.txt">here</a>.<br>
          <br>
        </div>
        <div class="col-md-6 col-xs-12"> <span style="font-weight:
            bold;">Final CTF</span><br>
          A final CTF will be run on during finals week consisting of
          two parts. The first, graded part will be the exam CTF
          consisting of several CTF levels that are similar to the
          homework CTF. This is to ensure that you have mastered the
          knowledge and skills the course is attempting to provide. When
          students complete the first part, they will go on to the
          second part, in which students will attempt to solve the final
          project CTF levels submitted as final projects by others. </div>
      </div>
      <!-- End assignments Featurette -->
      <!-- Begin objectives Featurette -->
      <hr class="featurette-divider">
      <div class="featurette lead" id="objectives">
        <div class="col-md-12">
          <h4 class="featurette-heading">Course objectives</h4>
        </div>
        <div class="col-md-6 col-xs-12">
          <ul>
            <li>Understand the underlying mechanisms used by malware on
              compromised systems.</li>
            <li>Understand counter-measures that detect malware.</li>
          </ul>
        </div>
        <div class="col-md-6 col-xs-12">
          <ul>
            <li>Understand techniques malware uses to circumvent and
              evade detection and analysis</li>
            <li>Develop skills to monitor the behavior of malware
              safely.</li>
            <li>Develop skills to reverse-engineer malware</li>
          </ul>
        </div>
      </div>
      <!-- End objectives Featurette -->
      <!-- Begin policies Featurette -->
      <hr class="featurette-divider">
      <div class="featurette lead" id="policies">
        <div class="col-md-12">
          <h4 class="featurette-heading">Policies</h4>
        </div>
        <div class="col-md-6 col-xs-6"><span style="font-weight: bold;">Grading</span>
          <section id="no-more-tables">
            <table class="table-bordered table-striped table-condensed
              cf">
              <tbody>
                <tr>
                  <td data-title="">Attendance</td>
                  <td data-title="">10%</td>
                </tr>
                <tr>
                  <td data-title="">Homeworks</td>
                  <td data-title="">30%</td>
                </tr>
                <tr>
                  <td data-title="">Lab notebook</td>
                  <td data-title="">35%</td>
                </tr>
                <tr>
                  <td data-title="">Final project</td>
                  <td data-title="">15%</td>
                </tr>
                <tr>
                  <td data-title="">Final CTF</td>
                  <td data-title="">10%</td>
                </tr>
              </tbody>
            </table>
          </section>
        </div>
        <div class="col-md-6 col-xs-12"><span style="font-weight: bold;">Academic


            misconduct</span><br>
          <ul>
            <li>Includes allowing another student to copy your work
              unless specifically allowed by the instructor.</li>
            <li>Results in a grade of 0 for the assignment or exam.</li>
            <li>Results in the initiation of disciplinary action at the
              <a href="https://www.pdx.edu/dos/academic-misconduct">university


                level</a>.</li>
          </ul>
        </div>
      </div>
      <!-- End policies Featurette -->
      <!-- Begin Footer -->
      <hr class="featurette-divider">
      <footer>
        <div class="row">
          <div class="col-lg-12"> </div>
        </div>
      </footer>
      <!-- End Footer --> </div>
    <!-- /.container -->
    <!-- jQuery -->
    <script src="../js/jquery.js"></script>
    <!-- Bootstrap Core JavaScript -->
    <script src="../js/bootstrap.min.js"></script>
  </body>
</html>
